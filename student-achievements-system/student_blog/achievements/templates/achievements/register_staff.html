{% extends 'achievements/base.html' %}
{% load static %}

{% block content %}
<!-- Hero Section -->
<section class="signup-hero">
    <div class="signup-hero-content">
        <h1>Register Staff Member</h1>
        <p>Create new staff accounts for CSE Achievers Portal</p>
    </div>
</section>

<!-- Staff Registration Form -->
<div class="signup-container">
    <div class="signup-card">
        <div class="signup-header">
            <h2>
                <i class="fas fa-user-tie"></i>
                Create Staff Account
            </h2>
            <p>Register a new staff member with admin privileges</p>
        </div>

        <div class="signup-body">
            {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                <i class="fas fa-{% if message.tags == 'success' %}check-circle{% else %}exclamation-circle{% endif %}"></i>
                {{ message }}
            </div>
            {% endfor %}
            {% endif %}

            <form method="POST" novalidate class="signup-form">
                {% csrf_token %}
                
                <!-- Personal Information -->
                <div class="form-row">
                    <div class="form-group">
                        <div class="form-icon">
                            <i class="fas fa-user"></i>
                        </div>
                        <label for="id_username">Username *</label>
                        {{ form.username }}
                        {% if form.username.errors %}
                        <div class="error-message">
                            <i class="fas fa-exclamation-circle"></i>
                            {{ form.username.errors.0 }}
                        </div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        <div class="form-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <label for="id_email">Email Address *</label>
                        {{ form.email }}
                        {% if form.email.errors %}
                        <div class="error-message">
                            <i class="fas fa-exclamation-circle"></i>
                            {{ form.email.errors.0 }}
                        </div>
                        {% endif %}
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <div class="form-icon">
                            <i class="fas fa-signature"></i>
                        </div>
                        <label for="id_first_name">First Name *</label>
                        {{ form.first_name }}
                    </div>

                    <div class="form-group">
                        <div class="form-icon">
                            <i class="fas fa-signature"></i>
                        </div>
                        <label for="id_last_name">Last Name *</label>
                        {{ form.last_name }}
                    </div>
                </div>

                <!-- Academic Information -->
                <div class="form-row">
                    <div class="form-group">
                        <div class="form-icon">
                            <i class="fas fa-id-card"></i>
                        </div>
                        <label for="id_roll_number">Staff ID *</label>
                        {{ form.roll_number }}
                        {% if form.roll_number.errors %}
                        <div class="error-message">
                            <i class="fas fa-exclamation-circle"></i>
                            {{ form.roll_number.errors.0 }}
                        </div>
                        {% endif %}
                        <small style="color: var(--text-light); display: block; margin-top: 0.5rem;">
                            Use format: STAFF001, STAFF002, etc.
                        </small>
                    </div>

                    <div class="form-group">
                        <div class="form-icon">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <label for="id_year">Year *</label>
                        {{ form.year }}
                    </div>
                </div>

                <div class="form-group">
                    <div class="form-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <label for="id_department">Department *</label>
                    {{ form.department }}
                </div>

                <div class="form-group">
                    <div class="form-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <label for="id_phone">Phone Number</label>
                    {{ form.phone }}
                </div>

                <!-- Password Section -->
                <div class="form-row">
                    <div class="form-group">
                        <div class="form-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                        <label for="id_password1">Password *</label>
                        {{ form.password1 }}
                        <div class="password-strength">
                            <div class="strength-bar" id="passwordStrength"></div>
                        </div>
                        {% if form.password1.errors %}
                        <div class="error-message">
                            <i class="fas fa-exclamation-circle"></i>
                            {{ form.password1.errors.0 }}
                        </div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        <div class="form-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                        <label for="id_password2">Confirm Password *</label>
                        {{ form.password2 }}
                        {% if form.password2.errors %}
                        <div class="error-message">
                            <i class="fas fa-exclamation-circle"></i>
                            {{ form.password2.errors.0 }}
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Staff Notice -->
                <div class="card" style="background: #f0f9ff; border: 1px solid #bae6fd; margin-bottom: 1.5rem;">
                    <h4 style="color: #0369a1; margin-bottom: 0.5rem;">
                        <i class="fas fa-info-circle"></i> Staff Account Information
                    </h4>
                    <p style="color: #075985; font-size: 0.875rem; margin-bottom: 0.5rem;">
                        This account will be created with staff privileges, allowing access to:
                    </p>
                    <ul style="color: #075985; font-size: 0.875rem; margin-left: 1rem;">
                        <li>Admin panel</li>
                        <li>Staff dashboard</li>
                        <li>User management</li>
                        <li>Achievement approval</li>
                    </ul>
                </div>

                <button type="submit" class="submit-btn">
                    <i class="fas fa-user-tie"></i>
                    Create Staff Account
                </button>
            </form>

            <div class="login-link">
                <p>Back to staff dashboard</p>
                <a href="{% url 'admin_dashboard' %}" class="login-btn">
                    <i class="fas fa-arrow-left"></i>
                    Return to Staff Dashboard
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add form control classes
    const formControls = document.querySelectorAll('input, select, textarea');
    formControls.forEach(control => {
        control.classList.add('form-control');
    });

    // Password strength indicator
    const passwordInput = document.getElementById('id_password1');
    const strengthBar = document.getElementById('passwordStrength');
    
    if (passwordInput && strengthBar) {
        passwordInput.addEventListener('input', function() {
            const password = this.value;
            let strength = 0;
            
            if (password.length >= 8) strength++;
            if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength++;
            if (password.match(/\d/)) strength++;
            if (password.match(/[^a-zA-Z\d]/)) strength++;
            
            strengthBar.className = 'strength-bar';
            if (strength === 0) {
                strengthBar.style.width = '0%';
            } else if (strength === 1) {
                strengthBar.classList.add('strength-weak');
            } else if (strength === 2 || strength === 3) {
                strengthBar.classList.add('strength-medium');
            } else {
                strengthBar.classList.add('strength-strong');
            }
        });
    }

    // Auto-fill staff ID if empty
    const rollNumberInput = document.getElementById('id_roll_number');
    if (rollNumberInput && !rollNumberInput.value) {
        rollNumberInput.placeholder = 'STAFF001';
    }
});
</script>
{% endblock %}